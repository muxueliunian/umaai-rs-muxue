# umaai-rs æ›´æ–°è®°å½•

> **åŸºçº¿ç‰ˆæœ¬**: umaai-rs-master
> **å½“å‰ç‰ˆæœ¬**: umaai-rs
> **å¯¹æ¯”æ—¥æœŸ**: 2025-12-08

---

## ğŸ“‹ å˜æ›´æ¦‚è¦

| ç±»å‹ | æ•°é‡ |
|------|------|
| æ–°å¢æ–‡ä»¶ | 14 ä¸ª |
| ä¿®æ”¹æ–‡ä»¶ | 5 ä¸ª |
| æ–°å¢ç›®å½• | 3 ä¸ª |

---

## ğŸ†• æ–°å¢æ–‡ä»¶

### 1. search/ æ¨¡å—ï¼ˆMCTS è’™ç‰¹å¡æ´›æœç´¢ï¼‰

**ç›®å½•**: `crates/umasim/src/search/`

| æ–‡ä»¶ | åŠŸèƒ½ | è¡Œæ•° |
|------|------|------|
| `mod.rs` | æ¨¡å—å…¥å£ï¼Œå…¬å¼€å¯¼å‡ºæ‰€æœ‰ç»„ä»¶ | ~47 |
| `search_param.rs` | æœç´¢å‚æ•°é…ç½®ï¼ˆè¿­ä»£æ¬¡æ•°ã€æ¢ç´¢å¸¸æ•°ç­‰ï¼‰ | - |
| `value_output.rs` | è¯„ä¼°å™¨è¾“å‡ºå€¼ï¼ˆscoreMean, scoreStdev, valueï¼‰ | - |
| `search_result.rs` | æœç´¢ç»“æœèšåˆï¼ˆåœ¨çº¿æ–¹å·®è®¡ç®—ï¼‰ | - |
| `evaluator.rs` | Evaluator trait + RandomEvaluator | - |
| `handwritten_evaluator.rs` | æ‰‹å†™å¯å‘å¼è¯„ä¼°å™¨ï¼ˆæ¸©æ³‰å‰§æœ¬ä¸“ç”¨ï¼‰ | - |
| `monte_carlo.rs` | è’™ç‰¹å¡æ´›æœç´¢æ ¸å¿ƒ + EvaluatorTrainerAdapter | - |

### 2. trainer/ æ¨¡å—ï¼ˆæ–°å¢è®­ç»ƒå‘˜ï¼‰

**ç›®å½•**: `crates/umasim/src/trainer/`

| æ–‡ä»¶ | åŠŸèƒ½ |
|------|------|
| `handwritten_trainer.rs` | æ‰‹å†™ç­–ç•¥è®­ç»ƒå‘˜ï¼Œç›´æ¥ä½¿ç”¨ HandwrittenEvaluator å†³ç­– |
| `mcts_trainer.rs` | MCTS è®­ç»ƒå‘˜ï¼ŒåŸºäºè’™ç‰¹å¡æ´›æœç´¢é€‰æ‹©åŠ¨ä½œ |
| `collector_trainer.rs` | æ•°æ®æ”¶é›†è®­ç»ƒå‘˜ï¼Œè¾¹å†³ç­–è¾¹æ”¶é›†ç¥ç»ç½‘ç»œè®­ç»ƒæ ·æœ¬ |

### 3. è®­ç»ƒæ•°æ®æ”¶é›†æ¨¡å—

**ç›®å½•**: `crates/umasim/src/`

| æ–‡ä»¶ | åŠŸèƒ½ |
|------|------|
| `training_sample.rs` | TrainingSample ç»“æ„ä½“ï¼Œ590 ç»´ç‰¹å¾ + åºåˆ—åŒ– |
| `sample_collector.rs` | SampleCollector æ ·æœ¬æ”¶é›†å™¨ï¼Œè®°å½•æ¯å›åˆå†³ç­–æ•°æ® |

### 4. äºŒè¿›åˆ¶ç¨‹åº

**ç›®å½•**: `crates/umasim/src/bin/`

| æ–‡ä»¶ | åŠŸèƒ½ |
|------|------|
| `generate_training_data.rs` | ç‹¬ç«‹çš„è®­ç»ƒæ•°æ®ç”Ÿæˆç¨‹åºï¼ˆå‘½ä»¤è¡Œå·¥å…·ï¼‰ |

### 5. æ–‡æ¡£

**ç›®å½•**: `docs/`

| æ–‡ä»¶ | åŠŸèƒ½ |
|------|------|
| `neural_network_training_master_plan.md` | ç¥ç»ç½‘ç»œè®­ç»ƒä¸»è®¡åˆ’ï¼ˆ590 ç»´ç‰¹å¾è®¾è®¡ã€ç½‘ç»œç»“æ„ã€è¿­ä»£è®­ç»ƒï¼‰ |
| `training_data_collection_plan_tasks.md` | è®­ç»ƒæ•°æ®æ”¶é›†ä»»åŠ¡æ¸…å•ï¼ˆé˜¶æ®µ 0-5 è¯¦ç»†ä»»åŠ¡ï¼‰ |

---

## âœï¸ ä¿®æ”¹æ–‡ä»¶

### 1. Cargo.tomlï¼ˆworkspace çº§åˆ«ï¼‰

**å˜æ›´**: æ–°å¢ `bincode` ä¾èµ–

```diff
+ bincode = "1.3.3"
```

### 2. crates/umasim/Cargo.toml

**å˜æ›´**: 
- æ–°å¢ `[[bin]]` é…ç½®ï¼ˆgenerate_training_dataï¼‰
- æ–°å¢ `bincode.workspace = true` ä¾èµ–

### 3. crates/umasim/src/lib.rs

**å˜æ›´**: æ–°å¢ 3 ä¸ªæ¨¡å—å¯¼å‡º

```diff
+ pub mod search;
+ pub mod training_sample;
+ pub mod sample_collector;
```

### 4. crates/umasim/src/main.rs

**å˜æ›´**:
- æ–°å¢ `run_collector_mode()` å‡½æ•°ï¼ˆæ ·æœ¬æ”¶é›†æ¨¡å¼ï¼‰
- æ–°å¢ `SimulationResult` ç»“æ„ä½“
- æ–°å¢ `print_simulation_stats()` ç»Ÿè®¡å‡½æ•°
- æ”¯æŒå¤šç§ trainer ç±»å‹: `mcts`, `handwritten`, `collector`
- æ”¯æŒå¤šæ¬¡æ¨¡æ‹Ÿç»Ÿè®¡ï¼ˆæœ€é«˜/æœ€ä½/å¹³å‡åˆ†ï¼‰

**è¡Œæ•°**: 106 â†’ 337 (+231)

### 5. crates/umasim/src/trainer/mod.rs

**å˜æ›´**: æ–°å¢ 3 ä¸ªå­æ¨¡å—å’Œå¯¼å‡º

```diff
+ pub mod handwritten_trainer;
+ pub mod mcts_trainer;
+ pub mod collector_trainer;
+ pub use handwritten_trainer::HandwrittenTrainer;
+ pub use mcts_trainer::MctsTrainer;
+ pub use collector_trainer::CollectorTrainer;
```

### 6. game_config.toml

**å˜æ›´**:
- æ‰©å±• trainer é€‰é¡¹è¯´æ˜ï¼ˆmcts, handwritten, collectorï¼‰
- æ–°å¢ collector æ¨¡å¼ä½¿ç”¨è¯´æ˜
- æ–°å¢ `simulation_count` é…ç½®é¡¹

**è¡Œæ•°**: 21 â†’ 45 (+24)

### 7. crates/umasim/src/game/onsen/game.rs

**å˜æ›´**: æ–°å¢ `extract_nn_features()` æ–¹æ³•ï¼ˆçº¦ 400 è¡Œï¼‰
- 590 ç»´ç¥ç»ç½‘ç»œè¾“å…¥ç‰¹å¾æå–
- å…¨å±€ä¿¡æ¯ï¼ˆ410 ç»´ï¼‰ï¼šå›åˆã€å±æ€§ã€è®­ç»ƒã€æ¸©æ³‰çŠ¶æ€ã€äº‹ä»¶é€‰é¡¹
- æ”¯æ´å¡ä¿¡æ¯ï¼ˆ180 ç»´ï¼‰ï¼š6 å¼ å¡ Ã— 30 ç»´

---

## ğŸ“‚ æ–°å¢ç›®å½•ç»“æ„

```
umaai-rs/
â”œâ”€â”€ docs/                              # ğŸ†• æ–°å¢ç›®å½•
â”‚   â”œâ”€â”€ neural_network_training_master_plan.md
â”‚   â””â”€â”€ training_data_collection_plan_tasks.md
â”‚
â””â”€â”€ crates/umasim/src/
    â”œâ”€â”€ bin/                           # ğŸ†• æ–°å¢ç›®å½•
    â”‚   â””â”€â”€ generate_training_data.rs
    â”‚
    â”œâ”€â”€ search/                        # ğŸ†• æ–°å¢ç›®å½•
    â”‚   â”œâ”€â”€ mod.rs
    â”‚   â”œâ”€â”€ search_param.rs
    â”‚   â”œâ”€â”€ value_output.rs
    â”‚   â”œâ”€â”€ search_result.rs
    â”‚   â”œâ”€â”€ evaluator.rs
    â”‚   â”œâ”€â”€ handwritten_evaluator.rs
    â”‚   â””â”€â”€ monte_carlo.rs
    â”‚
    â”œâ”€â”€ training_sample.rs             # ğŸ†• æ–°å¢æ–‡ä»¶
    â”œâ”€â”€ sample_collector.rs            # ğŸ†• æ–°å¢æ–‡ä»¶
    â”‚
    â””â”€â”€ trainer/
        â”œâ”€â”€ handwritten_trainer.rs     # ğŸ†• æ–°å¢æ–‡ä»¶
        â”œâ”€â”€ mcts_trainer.rs            # ğŸ†• æ–°å¢æ–‡ä»¶
        â””â”€â”€ collector_trainer.rs       # ğŸ†• æ–°å¢æ–‡ä»¶
```

---

## ğŸ¯ åŠŸèƒ½æ€»ç»“

### æ–°å¢åŠŸèƒ½

| åŠŸèƒ½ | è¯´æ˜ |
|------|------|
| MCTS æœç´¢ | è’™ç‰¹å¡æ´›æ ‘æœç´¢ï¼Œæ”¯æŒå¹¶è¡Œæ¨¡æ‹Ÿ |
| æ‰‹å†™è¯„ä¼°å™¨ | å¯å‘å¼æ¸©æ³‰å‰§æœ¬è¯„ä¼°é€»è¾‘ |
| ç¥ç»ç½‘ç»œç‰¹å¾ | 590 ç»´è¾“å…¥ç‰¹å¾æå– |
| è®­ç»ƒæ•°æ®æ”¶é›† | è¾¹æ¨¡æ‹Ÿè¾¹æ”¶é›†å†³ç­–æ•°æ® |
| æ¢ç´¢æ€§æ¸©æ³‰é€‰æ‹© | 40% éšæœºæ¢ç´¢æ”¯æŒå¤šæ ·åŒ–ç­–ç•¥å­¦ä¹  |
| å¤šæ¬¡æ¨¡æ‹Ÿç»Ÿè®¡ | æ”¯æŒæ‰¹é‡æ¨¡æ‹Ÿ + åˆ†æ•°ç»Ÿè®¡ |

### æ–°å¢ Trainer ç±»å‹

| Trainer | é…ç½®å€¼ | è¯´æ˜ |
|---------|--------|------|
| è’™ç‰¹å¡æ´›æœç´¢ | `"mcts"` | åŸºäº MCTS ç®—æ³• |
| æ‰‹å†™ç­–ç•¥ | `"handwritten"` | å¯å‘å¼è§„åˆ™å¿«é€Ÿå†³ç­– |
| æ•°æ®æ”¶é›† | `"collector"` | æ”¶é›†ç¥ç»ç½‘ç»œè®­ç»ƒæ•°æ® |

---

**è®°å½•äºº**: AI Agent è‡ªåŠ¨ç”Ÿæˆæ€»ç»“
**æ—¥æœŸ**: 2025-12-08

